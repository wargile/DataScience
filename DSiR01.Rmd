---
title: "DSiR00"
author: "Robert A. Stevens"
date: "March 8, 2016"
output: html_document
---

*Data Science in R: A Case Studies Approach to Computational Reasoning and Problem Solving*

by Deborah Nolan and Duncan Temple Lang

http://www.rdatasciencecases.org

# Chapter 1. Predicting Location via Indoor Positioning Systems 

by Deborah Nolan and Duncan Temple Lang

## 1.1 Introduction

### 1.1.1 Computational Topics

## 1.2 The Raw Data

```{r comment=NA}
options(digits = 2)
setwd("~/GitHub/DataScience")
#txt = readLines("Data/offline.final.trace.txt")
txt <- readLines("offline.final.trace.txt")
sum(substr(txt, 1, 1) == "#")
length(txt)
```

### 1.2.1 Processing the Raw Data

```{r comment=NA}
strsplit(txt[4], ";")[[1]]
tokens <- strsplit(txt[4], "[;=,]")[[1]]
tokens[1:10]
tokens[c(2, 4, 6:8, 10)]
tokens[-(1:10)]
tmp <- matrix(tokens[-(1:10)], ncol = 4, byrow = TRUE)
mat <- cbind(matrix(tokens[c(2, 4, 6:8, 10)], 
                    nrow = nrow(tmp),
                    ncol = 6, 
                    byrow = TRUE), 
             tmp)
dim(mat)
processLine <- function(x) {
  tokens <- strsplit(x, "[;=,]")[[1]]
  tmp <- matrix(tokens[-(1:10)], ncol = 4, byrow = TRUE)
  cbind(matrix(tokens[c(2, 4, 6:8, 10)], 
               nrow = nrow(tmp),
               ncol = 6, 
               byrow = TRUE), 
        tmp)
}
tmp <- lapply(txt[4:20], processLine)
sapply(tmp, nrow)
offline <- as.data.frame(do.call("rbind", tmp))
dim(offline)
lines <- txt[ substr(txt, 1, 1) != "#" ]
tmp <- lapply(lines, processLine)
processLine <- function(x) {
  tokens <- strsplit(x, "[;=,]")[[1]]
  if (length(tokens) == 10) 
    return(NULL)
  tmp <- matrix(tokens[ - (1:10) ], , 4, byrow = TRUE)
  cbind(matrix(tokens[c(2, 4, 6:8, 10)], 
               nrow(tmp), 
               6, 
               byrow = TRUE), 
        tmp)
}
options(error = recover, warn = 1)
tmp <- lapply(lines, processLine)
offline <- as.data.frame(do.call("rbind", tmp), stringsAsFactors = FALSE)
dim(offline)
```

## 1.3 Cleaning the Data and Building a Representation for Analysis

```{r comment=NA}

```

### 1.3.1 Exploring Orientation

```{r comment=NA}

```

### 1.3.2 Exploring MAC Addresses

```{r comment=NA}

```

### 1.3.3 Exploring the Position of the Hand-Held Device

```{r comment=NA}

```

### 1.3.4 Creating a Function to Prepare the Data

```{r comment=NA}

```

## 1.4 Signal Strength Analysis

```{r comment=NA}

```

### 1.4.1 Distribution of Signal Strength

```{r comment=NA}

```

### 1.4.2 The Relationship between Signal and Distance

```{r comment=NA}

```

## 1.5 Nearest neighbor Methods to Predict Location

```{r comment=NA}

```

### 1.5.1 Preparing the Test Data

```{r comment=NA}

```

### 1.5.2 Choice of Orientation

```{r comment=NA}

```

### 1.5.3 Finding the Nearest Neighbors

```{r comment=NA}

```

### 1.5.4 Cross-Validation and Choice of k

```{r comment=NA}

```

## 1.6 Exercises
